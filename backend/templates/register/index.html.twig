{% extends 'base.html.twig' %}

{% block title %}Inscription{% endblock %}

{% block body %}
<h1>Inscription</h1>

<form id="register-form">
    <input name="firstname" placeholder="PrÃ©nom" required>
    <input name="lastname" placeholder="Nom" required>
    <input name="mail" type="email" placeholder="Email" required>
    <input name="password" type="password" placeholder="Mot de passe" required>
    <button>S'inscrire</button>
</form>

<p id="message"></p>

<script>
document.getElementById('register-form').addEventListener('submit', async e => {
    e.preventDefault();

    const form = e.target;
    const data = {
        firstname: form.firstname.value,
        lastname: form.lastname.value,
        mail: form.mail.value,
        password: form.password.value
    };

    const res = await fetch('/api/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    });

    const json = await res.json();
    document.getElementById('message').innerText =
        res.ok ? 'Inscription rÃ©ussie ðŸŽ‰' : json.error;
});
</script>
{% endblock %}
